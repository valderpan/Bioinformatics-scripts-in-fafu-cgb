et <- exactTest(y_bcv, dispersion = bcv ^ 2)
gene1 <- decideTestsDGE(et, p.value = 0.05, lfc = 0)
summary(gene1)
y_bcv <- y
bcv <- 0.1
et <- exactTest(y_bcv, dispersion = bcv ^ 2)
gene1 <- decideTestsDGE(et, p.value = 0.05, lfc = 0)
summary(gene1)
y_bcv <- y
bcv <- 0.2
et <- exactTest(y_bcv, dispersion = bcv ^ 2)
gene1 <- decideTestsDGE(et, p.value = 0.05, lfc = 0)
summary(gene1)
colnames(gene1) <- "Signifi"
results <- cbind(y$genes,y$counts,et$table,gene1)
y$genes
y
et$table
y
y$counts
results <- cbind(y$counts,et$table,gene1)
head(result)
head(results)
View(y)
write.csv(results,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\result.txt.tab',sep = '\t')
write.csv(results,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\result.txt.csv',row.names = F)
write.csv(results,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\result.test.csv)
write.csv(results,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\result.test.csv')
summary(gene1)
head(df1)
result
results
library(dplyr)
select(results[,6]=1)
select(result[results[,6]=1])
result[results[,6]=1]
results[,6]=1
results
results <- cbind(y$counts,et$table,gene1)
head(results)
results$Signifi=1
head(results)
results <- cbind(y$counts,et$table,gene1)
results$Signifi>1
results$Signifi==1
results[results$Signifi==1]
results[results$Signifi==1]
results[results$Signifi==1]
results[,results$Signifi==1]
results[results$Signifi==1,]
summary(results)
summary(gene1)
results[results$Signifi==1,]
up <- results[results$Signifi==1,]
down <- results[results$Signifi==-1,]
library(openxlsx)
DEG <- results[results$Signifi!=0,]
sheets <- list('DEG_overview_result'=DEG,'up_regulated_gene'=up,'down_regulated_gene'=down)
write.xlsx(sheets,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\test.xlsx')
write.xlsx(sheets,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\test.xlsx')
install.packages('stringr')
install.packages("stringr")
write.xlsx(sheets,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\test.xlsx')
library(openxlsx)
write.xlsx(sheets,'C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\test.xlsx')
df1
View(df1)
head(df)
#df1 <- df[,c(2,1)]
df1 <- df[,c(2,1)]
head(df1)
df2 = select(2,1)
library(dplyr)
df2 = df2 %>% select(2,1)
df2 = df %>% select(2,1)
head(df2)
head(df1)
df3 <- df %>% select(2)
df4 <- df %>% select(1)
df5 <- cbind(df3,df4)
head(df5)
head(df)
rm(list = ls())
df <- read.delim('C:\\Users\\dell\\Desktop\\广西大学抗旱RNA-Seq\\counts_id.txt',row.names = 1)
head(df)
df <- df[,-(1:5)]
head(df)
df1 <- df[,c(2,1)]
head(df1)
colnames(df1)
paste(colnames(df1))
paste(colnames(df1),sep = 'vs')
paste(colnames(df1),sep = '---')
paste(colnames(df1)[0],colnames(df1)[1],sep = '---')
paste(colnames(df1)[0],colnames(df1)[1],sep = '-')
paste((colnames(df1)[0],colnames(df1)[1]),sep = '-')
paste(colnames(df1)[1],colnames(df1)[2],sep = '-')
paste(colnames(df1)[1],colnames(df1)[2],sep = 'vs')
paste(colnames(df1)[1],colnames(df1)[2],sep = '_vs_')
paste(colnames(df1)[1],colnames(df1)[2],'.xlsx',sep = '_vs_')
paste(colnames(df1)[1],colnames(df1)[2].xlsx,sep = '_vs_')
paste(colnames(df1)[1],colnames(df1)[2],sep = '_vs_')
result_name = paste(colnames(df1)[1],colnames(df1)[2],sep = '_vs_')
paste(result_name,'.xlsx',sep = '')
as.numeric(0.2)
as.numeric("0.2")
library('ggplot2')
install.packages(;glue)
install.packages('glue')
library('ggplot2')
install.packages('vctrs')
ll
library('ggplot2')
library(xlsx)
df <- read.xlsx('D:\调控元件生信任务\文献\6.高粱和玉米亚基因组中差异调控的直系同源基因',sheetindex=2)
df <- read.xlsx('D:\\调控元件生信任务\\文献\\6.高粱和玉米亚基因组中差异调控的直系同源基因',sheetindex=2)
df <- read.xlsx('D:\\调控元件生信任务\\文献\\6.高粱和玉米亚基因组中差异调控的直系同源基因\\Supplemental_Data_Set_4.xlsx',sheetindex=2)
df <- read.xlsx('D:\\调控元件生信任务\\文献\\6.高粱和玉米亚基因组中差异调控的直系同源基因\\Supplemental_Data_Set_4.xlsx')
df <- read.xlsx('D:\\调控元件生信任务\\文献\\6.高粱和玉米亚基因组中差异调控的直系同源基因\\Supplemental_Data_Set_4.xlsx',sheetindex=2)
?read.xlsx
df <- read.xlsx('D:\\调控元件生信任务\\文献\\6.高粱和玉米亚基因组中差异调控的直系同源基因\\Supplemental_Data_Set_4.xlsx',sheetIndex=2)
head(df)
View(df)
df <- read.xlsx('D:\\调控元件生信任务\\文献\\6.高粱和玉米亚基因组中差异调控的直系同源基因\\Supplemental_Data_Set_4.xlsx',sheetIndex=2)
ggplot(df,aes(Time,full=Sort))+geom_bar(aes(y=additive))
library(reshape2)
install.packages('stringi')
library(reshape2)
head(df)
melt(df,id.vars = c('Time','Sort'))
df_melt <- melt(df,id.vars = c('Time','Sort'))
head(df_melt)
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=Sort),stat = 'identity',position = 'fill',color='black')
ggplot(df_melt,aes(Time,fill=Sort))+geom_bar(aes(y=variable),stat = 'identity',position = 'fill',color='black')
data <- read.xlsx('C:\\Users\\dell\\Desktop\\Nepal_project\\20200717 Nepal-AP85-compartment-variation\\Four-species_compartment_count.xlsx',sheetIndex = 3)
data <- read.xlsx('C:\\Users\\dell\\Desktop\\Nepal_project\\20200717 Nepal-AP85-compartment-variation\\Four-species_compartment_count.xlsx',sheetIndex = 3)
head(data)
ggplot(df_melt,aes(Time,fill=Sort))+geom_bar(aes(y=value),stat = 'identity',position = 'fill',color='black')
ggplot(df_melt,aes(Time,fill=Sort))+geom_bar(aes(y=value),stat = 'identity',position = 'stack',color='black')
ggplot(df_melt,aes(Time,fill=Sort))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')
ggplot(df_melt,aes(Time,fill=Sort))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~variable)
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+theme(panel.border = element_rect(color = 'transparent'))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("red", "blue"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("blue", "red"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#CC3300"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#CC0033"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#FF3333"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#FF0066"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#CC0033"))
head(df)
head(df_melt)
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#CC0033"))
ggplot(df_melt,aes(Time,fill=variable))+geom_bar(aes(y=value),stat = 'identity',position = 'dodge',color='black')+facet_wrap(~Sort)+theme_bw()+xlab('')+ylab('gene pairs numbers')+scale_fill_manual(values=c("#3399FF", "#CC0033"))+theme(legend.position="top")
install.packages('ggseqlogo')
library(ggseqlogo)
motif_seq <- c(
"CCCATTGTTCTC",
"TTTCTGGTTCTC",
"TCAATTGTTTAG",
"CTCATTGTTGTC",
"TCCATTGTTCTC",
"CCTATTGTTCTC",
"TCCATTGTTCGT",
"CCAATTGTTTTG"
)
class(motif_seq)
ggseqlogo(motif_seq)
ggseqlogo(motif_pfm, col_scheme='base_pairing')
ggseqlogo(motif_seq, col_scheme='base_pairing')
motif_list <- list(
"A"=motif_pfm,
"B"=motif_pfm,
"C"=motif_pfm,
"D"=motif_pfm)
motif_pfm <- rbind(
c(0, 0, 2, 7, 0, 0, 0, 0, 0, 0, 1, 0),
c(4, 6, 4, 1, 0, 0, 0, 0, 0, 5, 0, 5),
c(0, 0, 0, 0, 0, 1, 8, 0, 0, 1, 1, 2),
c(4, 2, 2, 0, 8, 7, 0, 8, 8, 2, 6, 1)
)
rownames(motif_pfm) <- c("A", "C", "G", "T")
motif_pfm
motif_list <- list(
"A"=motif_pfm,
"B"=motif_pfm,
"C"=motif_pfm,
"D"=motif_pfm)
ggseqlogo(motif_list,ncol = 2)
motif_seq
df <- read.delim('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx')
library(xlsx)
df <- read.delim('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx')
df <- read.xlsx('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx',sheetIndex = 1)
df <- read.xlsx('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx',sheetIndex = 1)
df <- read.xlsx2('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx',sheetIndex = 1)
rm(list = ls())
df <- read.xlsx('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx',sheetIndex = 1)
install.packages('readxl')
library(readxl)
df <- read_excel('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx')
head(df)
View(df)
class(df)
type(df)
dd <- as.data.frame(df)
class(dd)
excel_sheets(df)
excel_sheets('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx')
library(factoextra)
head(dd)
fviz_nbclust(df, kmeans, method = "wss")
fviz_nbclust(dd, kmeans, method = "wss")
df[rowMeans(df)==0,]
df <- df[rowMeans(df)==0,]
dd[rowMeans(dd)==0,]
View(dd)
dd <- as.data.frame(df,colnames(1))
head(dd)
View(dd)
colnames(dd) <- dd[,1]
dd <- as.data.frame(df,row.names = 1)
View(dd)
df <- read_excel('D:\\Result\\Transit\\fpkm_caculate\\全套\\SES_leaffregment_fpkm.xlsx',row.names=1)
head(dd)
rownames(dd) <- dd[,1]
dd <- dd[,-1]
fviz_nbclust(dd, kmeans, method = "wss")
dd[rowMeans(dd)==0,]
dd[rowMeans(dd)>0,]
dd[rowMeans(dd)<0,]
dim(dd[rowMeans(dd)==0,])
dim(dd[rowMeans(dd)<1,])
dd <- dd[rowMeans(dd)>1]
dd <- dd[rowMeans(dd)>1,]
fviz_nbclust(dd, kmeans, method = "wss")
head(dd)
dd[rowMeans(dd)>5,]
dd[rowMeans(dd)>10,]
dd2 <- dd[rowMeans(dd)>10,]
fviz_nbclust(dd2, kmeans, method = "wss")
dd1 <- dd[rowMeans(dd)>5,]
fviz_nbclust(dd1, kmeans, method = "wss")
library(clusterProfiler)
go_anno <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20200528 GOKEGG\\N-go.annot',sep='\t',header = FALSE)
View(go_anno)
gene_select <- read.delim(Nepal_v_AP85_L_diff_Nepal_high.txt,sep='\t',header = FALSE)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\Nepal_v_AP85_L_diff_Nepal_high.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = opt$pvalueCutoff,
pAdjustMethod = 'BH')
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\Nepal_v_AP85_L_diff_Nepal_low.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\Nepal_v_AP85_S_diff_Nepal_low.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\Nepal_v_AP85_S_diff_Nepal_high.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\Nepal_v_AP85_L_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\L_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
barplot(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\S_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
go_anno <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20200528 GOKEGG\\N-go.annot',sep='\t',header = FALSE)
head(go_anno)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\L_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\S_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
barplot(go_enrich)
View(go_enrich)
dim(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\L_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
dim(go_enrich)
barplot(go_enrich)
View(go_enrich)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\S_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.05,
pAdjustMethod = 'BH')
dim(go_enrich)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.5,
pAdjustMethod = 'BH')
dim(go_enrich)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.1,
pAdjustMethod = 'BH')
dim(go_enrich)
barplot(go_enrich)
dotplot(go_enrich)
barplot(go_enrich)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.5,
pAdjustMethod = 'BH')
barplot(go_enrich)
barplot(go_enrich,showCategory = 20)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.1,
pAdjustMethod = 'BH')
barplot(go_enrich,showCategory = 20)
barplot(go_enrich,showCategory = 30)
gene_select <- read.delim('C:\\Users\\dell\\Desktop\\Nepal_project\\20201007_AP85_NPX_fpkm\\query_geneid_V2\\L_diff_Nepal_all.txt',sep='\t',header = FALSE)
gene_select <-as.vector(gene_select$V1)
go_enrich <- enricher(gene = gene_select,
TERM2GENE = go_anno[c('V2', 'V1')],
TERM2NAME = go_anno[c('V2', 'V3')],
pvalueCutoff = 0.1,
pAdjustMethod = 'BH')
barplot(go_enrich)
barplot(go_enrich,showCategory = 20)
library(ggplot2)
data(mtcars)
df <- mtcars
head(df)
df <- mtcars[,c('mpg','cyl','wt')]
head(df)
dim(df[,1])
dim(df)
dim(df$mpg)
df$cyl <- as.factor(df$cyl)
head(df)
ggplot(df,aes(mpg,wt))+geom_path()
ggplot(df,aes(mpg,wt))+geom_point()
ggplot(df,aes(mpg,wt,fill=cyl))+geom_point()
ggplot(df,aes(mpg,wt,color=cyl))+geom_point()
data(mpg)
ggplot(mpg,aes(x=fill))
ggplot(mpg,aes(x=f1))
ggplot(mpg,aes(x=fl))
ggplot(mpg,aes(x=fl))+geom_bar()
head(mpg)
ggplot(mpg,aes(x=fl))+geom_bar(fill = 'strrlblue',color='red')
ggplot(mpg,aes(x=fl))+geom_bar(fill = 'steelblue',color='red')
ggplot(mpg,aes(x=fl))+geom_bar(fill = 'steelblue',color='black')
head(faithful)
ggplot(faithful,aes(eruptions,waiting))+geom_point()
ggplot(faithful,aes(eruptions,waiting))+geom_point()+geom_rug9)
ggplot(faithful,aes(eruptions,waiting))+geom_point()+geom_rug(0)
ggplot(faithful,aes(eruptions,waiting))+geom_point()+geom_rug()
d <- ggplot(data = economics, aes(x=date, y=unemploy))
d+geom_area()
d+geom_area()+geom_point()
d+geom_point()
d+geom_line()
d+geom_step()
ggplot(diamonds, aes(cut, color)) +
geom_jitter(aes(color = cut), size = 0.5)
install.packages("ggseqlogo")
library(ggseqlogo)
data(ggseqlogo_sample)
class(seqs_aa)
head(seqs_aa[1])
head(seqs_aa)[1]
head(seqs_aa)
head(pfms_dna)[1]
library(ggplot2)
ggplot()+geom_logo(seqs_dna$MA0001.1)+theme_logo()
head(seqs_dna$MA0001.1)
seqs_dna$MA0001.1
class(seqs_dna$MA0001.1)
setwd('D:\\FAFU-CGB\\Nepal_project\\20200508 Nepal_chr_Ks\\Median\\nepal_ks_median')
#-----V3-----
df <- read.delim('result_mean.txt',sep = '\t')
head(df)
ggplot(df,aes(x=Chr,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
library(ggplot2)
ggplot(df,aes(x=Chr,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
head(df)
ggplot(df,aes(x=id,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
ggplot(df,aes(x=id,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.05)
ggplot(df,aes(x=id,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0.01,0.05)
ggplot(df,aes(x=id,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0.01,0.04)
data <- read.delim('result.txt',sep = '\t')
data <- read.delim('result_mean.txt',sep = '\t')
#-----V1-----
dataks <- select(data,id,Type,Ks,Ks_std)
library(dplyr)
#-----V1-----
dataks <- select(data,id,Type,Ks,Ks_std)
head(data)
library(readxl)
df <- read_excel('ChrKS_v3_boxplot.xlsx')
head(df)
ggplot(df,aes(x=Chr,y=value))+geom_boxplot()
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot()
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot(outlier.colour = NA)
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot(outlier.colour = NA)+ylim(0,0.2)
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])
library(tidyquant)
x1 <- palette_light()
ggplot(df,aes(x=Chr,y=Ks))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])
x1 <- palette_dark()
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])
df$Chr <- factor(df$Chr,levels = c('Chr1','Chr2','Chr3','Chr4','Chr5','Chr6','Chr7','Chr8','Chr9','Chr10'))
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.3)
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_classic()
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_classic()+theme(legend.position="none")
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
head(df)
#-----V3-----
df <- read.delim('ChrKS_v3_boxplot.xlsx',sep = '\t')
head(df)
#ggplot(df,aes(x=Chr,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
df$Chr <- factor(df$Chr,levels = c('Chr1','Chr2','Chr3','Chr4','Chr5','Chr6','Chr7','Chr8','Chr9','Chr10'))
head(df)
#-----V3-----
df <- read_excel('ChrKS_v3_boxplot.xlsx')
head(df)
#ggplot(df,aes(x=Chr,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
df$Chr <- factor(df$Chr,levels = c('Chr1','Chr2','Chr3','Chr4','Chr5','Chr6','Chr7','Chr8','Chr9','Chr10'))
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.colour = NA)
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot()
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(-3,21)
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
df <- read_excel('ChrKs_v3_cprrect.boxplot.xlsx')
#ggplot(df,aes(x=Chr,y=Ks,fill=type))+geom_boxplot(outlier.colour = NA)+ylim(0,0.1)
df$Chr <- factor(df$Chr,levels = c('Chr1','Chr2','Chr3','Chr4','Chr5','Chr6','Chr7','Chr8','Chr9','Chr10'))
ggplot(df,aes(x=Chr,y=Ks,fill=Chr))+geom_boxplot(outlier.colour = NA)+ylim(0,0.15)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
ggplot(df,aes(x=Chr,y=KaKs))+geom_boxplot()
ggplot(df,aes(x=Chr,y=KaKs))+geom_boxplot(outlier.color = NA)
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(0,1)
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(0,2)
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(0,2)+scale_fill_manual(values = matrix(x1)[,1])
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(0,2)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(0,1.5)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
ggplot(df,aes(x=Chr,y=KaKs,fill=Chr))+geom_boxplot(outlier.color = NA)+ylim(0,2)+scale_fill_manual(values = matrix(x1)[,1])+stat_boxplot(geom = 'errorbar',width=0.4)+theme_bw()+theme(legend.position="none")+xlab('')
#-----V2-----
df <- read.table('result_median_ChrAverage.txt',sep = '\t',header = T)
x1 <- palette_dark()
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_bar(stat='identity',color='black',width = 0.9)+theme_classic()+xlab('')+geom_errorbar(aes(x=id,ymax=Ks+Ks_std,ymin=Ks-Ks_std),width=0.3,size=0.7)+theme(legend.position="none")+scale_fill_manual(values = matrix(x1)[,1])
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_boxplot()
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_boxplot()+ylim(0,0.05)
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_boxplot()+ylim(0.01,0.05)
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_boxplot()+ylim(0.01,0.04)
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_boxplot()+ylim(0.02,0.04)
ggplot(df,aes(x=id,y=Ks,fill=id))+geom_boxplot()+ylim(0.01,0.04)
